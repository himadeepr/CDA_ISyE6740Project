+       pred = predict(ada_model, valid_ada_X, probability = TRUE)
+       pred = pred$prob[,2]
+       
+       pred_final = pred_final + pred
+       #pred_final = pred_final + rank(pred, ties.method = "random")
+       
+     } # end of bagging 
+     #pred_final = seq(from=0, to=1, length.out=nrow(valid_x))[rank(pred_final, ties.method = "random")]
+     pred_final = pred_final / z
+     auc_scores[cv] = evaluation(pred_final, valid_x[,ncol(valid_x)])
+     cat(auc_scores[cv], " ")
+   } # end of CV
+   cat("\n")
+   print(auc_scores)
+   cat("mean: ", mean(auc_scores), "sd: ", sd(auc_scores))
+   total_scores[r] = mean(auc_scores)
+ }
Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8185185  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9666344  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9284333  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8781431  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9473404  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8856383  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9066489  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8787234  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.962234  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9319149  
 [1] 0.8185185 0.9666344 0.9284333 0.8781431 0.9473404 0.8856383 0.9066489 0.8787234 0.9622340 0.9319149

mean:  0.9104229 sd:  0.04608578Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9193122  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8853965  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8423598  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9719536  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9398936  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.875266  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.831117  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.95  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9574468  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.887234  
 [1] 0.9193122 0.8853965 0.8423598 0.9719536 0.9398936 0.8752660 0.8311170 0.9500000 0.9574468 0.8872340

mean:  0.9059979 sd:  0.04903222Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9333333  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8636364  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9182785  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9647002  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9164894  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9303191  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8553191  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8731383  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9367021  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9  
 [1] 0.9333333 0.8636364 0.9182785 0.9647002 0.9164894 0.9303191 0.8553191 0.8731383 0.9367021 0.9000000
mean:  0.9091917 sd:  0.03553544Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8164021  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8612186  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.934236  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.94294  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9510638  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8393617  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.887766  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8664894  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9925532  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9553191  
 [1] 0.8164021 0.8612186 0.9342360 0.9429400 0.9510638 0.8393617 0.8877660 0.8664894 0.9925532 0.9553191
mean:  0.904735 sd:  0.05818343Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8259259  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8926499  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9105416  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.832205  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9297872  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9632979  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8920213  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9404255  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9558511  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9390957  
 [1] 0.8259259 0.8926499 0.9105416 0.8322050 0.9297872 0.9632979 0.8920213 0.9404255 0.9558511 0.9390957
mean:  0.9081801 sd:  0.04809566Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8941799  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9552708  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8409091  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8996615  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9420213  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9053191  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9494681  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9069149  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9531915  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8930851  
 [1] 0.8941799 0.9552708 0.8409091 0.8996615 0.9420213 0.9053191 0.9494681 0.9069149 0.9531915 0.8930851
mean:  0.9140021 sd:  0.03618798Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9444444  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8974855  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9564797  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9647002  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8446809  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9013298  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.925266  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9521277  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8212766  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8648936  
 [1] 0.9444444 0.8974855 0.9564797 0.9647002 0.8446809 0.9013298 0.9252660 0.9521277 0.8212766 0.8648936
mean:  0.9072684 sd:  0.05019614Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9275132  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8554159  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.938588  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9052224  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9664894  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9324468  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8404255  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9457447  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9345745  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8414894  
 [1] 0.9275132 0.8554159 0.9385880 0.9052224 0.9664894 0.9324468 0.8404255 0.9457447 0.9345745 0.8414894
mean:  0.908791 sd:  0.04621499Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8793651  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8457447  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9453578  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9361702  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9898936  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9015957  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8119681  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9239362  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9404255  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9468085  
 [1] 0.8793651 0.8457447 0.9453578 0.9361702 0.9898936 0.9015957 0.8119681 0.9239362 0.9404255 0.9468085
mean:  0.9121265 sd:  0.05322463Scores: CV:  1 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9333333  CV:  2 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.907882  CV:  3 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8438104  CV:  4 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8931335  CV:  5 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9138298  CV:  6 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9425532  CV:  7 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9  CV:  8 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.8696809  CV:  9 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9143617  CV:  10 
1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  0.9393617  
 [1] 0.9333333 0.9078820 0.8438104 0.8931335 0.9138298 0.9425532 0.9000000 0.8696809 0.9143617 0.9393617
mean:  0.9057946 sd:  0.03112477> 
> print("\nTOTAL RUns SCORES: \n")
[1] "\nTOTAL RUns SCORES: \n"
> print(total_scores)
 [1] 0.9104229 0.9059979 0.9091917 0.9047350 0.9081801 0.9140021 0.9072684 0.9087910 0.9121265 0.9057946
> print(mean(total_scores))
[1] 0.908651
> save.image("2stageada.RData")
> ls()
 [1] "ada_model"      "auc_scores"     "bag_index"      "baggingRuns"    "bagSize"        "boos"           "coeflearn"     
 [8] "cost"           "cv"             "CV_index"       "CV_split"       "df"             "evaluation"     "gamma"         
[15] "K"              "mfinal"         "minsplit"       "mtry"           "ntree"          "OOB_index"      "OOB_index_temp"
[22] "outcome"        "pred"           "pred_final"     "r"              "rf_model"       "rf_pred"        "rf_pred_valid" 
[29] "stra_index"     "svm_model"      "svm_pred"       "svm_pred_valid" "template"       "test"           "TOTAL_RUNS"    
[36] "total_scores"   "train"          "train_ada"      "train_x"        "train_x_rf"     "trind"          "valid_ada_X"   
[43] "valid_index"    "valid_template" "valid_x"        "valid_x_rf"     "X_ada"          "X_rf"           "X_svm"         
[50] "y_ada"          "y_rf"           "y_svm"          "z"             
> total_scores
 [1] 0.9104229 0.9059979 0.9091917 0.9047350 0.9081801 0.9140021 0.9072684 0.9087910 0.9121265 0.9057946
> auc_scores
 [1] 0.9333333 0.9078820 0.8438104 0.8931335 0.9138298 0.9425532 0.9000000 0.8696809 0.9143617 0.9393617
> 
